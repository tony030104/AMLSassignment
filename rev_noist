import os
import cv2

# PATH TO ALL IMAGES
basedir = 'C:/Users/user/PycharmProjects/Assignment/venv'
images_dir = os.path.join(basedir,'dataset')

# Create the face cascade
face_patterns = cv2.CascadeClassifier(os.path.join(basedir,'haarcascade_frontalface_default.xml'))

Train = []
Test = []
c = 1
count = 0

training_set = 'C:/Users/user/PycharmProjects/Assignment/venv/training_set'
testing_set = 'C:/Users/user/PycharmProjects/Assignment/venv/testing_set'
os.mkdir(training_set)
os.mkdir(testing_set)

for img in os.listdir(images_dir):
    im = str(c)+'.png'

    # Read the image
    image = cv2.imread(os.path.join(images_dir,im))
    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

    # Detect faces in the image
    faces = face_patterns.detectMultiScale(
       gray,
       scaleFactor=1.009,
       minNeighbors=5,
      minSize=(100, 100),
    )

    img_d = 'detected' + im
    if len(faces) != 0:
        count += 1
        if c>4000:
            Test.append(c)
            cv2.imwrite(os.path.join(testing_set, img_d), image);
        else:
            Train.append(c)
            cv2.imwrite(os.path.join(training_set, img_d), image);
    for (x, y, w, h) in faces:
       cv2.rectangle(image, (x, y), (x+w, y+h), (0, 255, 0), 2)
    if im == '1220.png':
        cv2.imwrite(os.path.join(basedir,img_d), image);
    c += 1

print(count)
